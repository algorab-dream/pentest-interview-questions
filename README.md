# Pentest interview questions

This is a non exhaustive list of questions that can be asked during pentetration tester technical interview. Being able to provide full and detailed answers to all of those questions should be a good preparation for those interviews.

## What is an XSS ?

An XSS (Cross Site Scripting) is a web security vulnerability that allows an attacker to run custom script in the context of a victim browser. These vulnerabilities arise when the user input is not properly filtered, and can lead to session or data stealing, or more generaly to perform any action the victim is allowed to do on the vulnerable application.

## What is a SQL injection ?

A SQL injection is a web security vulnerability that allows an attacker to perform queries against the database by using unsanitized query parameters. This can allow the attacker to read the database, but could also allow to write into the database, to write files or even to execute commands.

## Explain Kerberos protocol and some attacks on it.

The Kerberos protocol is an authentication protocol that relies on a ticket-based authentication. It is maily used in Active Directory environments. Here is the all protocol for accessing a service:

#### AS_REQ - Authentication Server Request
The client sends its username, and a timestamp encrypted using user's hash. The domain controller, acting as a KDC, also maintains the Authentication Server service. 
When recieving the request, it looks up the password hash of the user in the `ntds.dit` and decrypts the timestamp. If the decryption is successful and the timestamp is valid, the authentication is successful.

#### AS_REP - Authentication Server Reply
The Authentication Server replies with a session key and a Ticket-Granting-Ticket (TGT). The session key is encrypted using user's hash. The TGT contains information regarding the user, the timestamp, the domain, the IP address of the client, and the session key. This ticket is encrypted using `krbtgt` account hash. Only the KDC can decrypt this ticket.
The TGT is valid for a certain amount of time, and can be renewed without needing the user to authenticate again.

#### TGS_REQ - Ticket-Granting-Server Request
The client contacts again the KDC in order to access ressources of the domain. It sends its username with a timestamp encrypted with the session key, the name of the ressource it wishes to access, and the encrypted TGT.
The KDC checks that the ressource exists and decrypts the TGT. The session key is extracted from the decrypted TGT and used to decrypt the timestamp of the request and the username. The KDC checks that the timestamp is valid, the usernames from the TGT and from the TGS_REQ match, and that the client IP address matches the IP address from the TGT. If all those checks pass, the request is valid.

#### TGS_REP - Ticket-Granting-Server Reply
The KDC replies with a packet containing the name of the service for which accesss has been granted, a session key to be used between the client and the service, and a service ticket containing the username, group memberships and the newly-created session key.
The service name and the session key are encrypted using session key associated with the TGT, whereas service ticket itself is encrypted using the hash of the service account registered with this service.

#### AP_REQ - Application Request
Now, the client send a request to the application server, including username and timestamp encrypted with the session key, and the service ticket. The application server decrypts the service ticket with the service account password hash, and extracts the username and the session key. It then uses the session key to decrypt username and timstamp from the request. If the usernames match, the request is valid, and the service checks that user is allowed to access it, and assigns appropriate permissions to the user.

#### Kerberoasting and ASREProasting
The two main attacks against Kerberos protocol are Kerberoasting and ASREProasting.
Kerberoasting occurs when a service account has a predictable password. An authenticated user can issue a service ticket for the service linked to this account, and try to decrypt the service ticket offline by bruteforcing the service account password.
ASREProasting occurs when an account does not need Kerberos preauthentication, which is sending the AS_REQ to get the AS_REP. Then, anyone can get a session key encrypted with user's hash, and then perform offline bruteforce to retrieve the password.

## Explain NTLM protocol

NTLM is used when a client authenticates using a server IP instead of its hostname, or when the hostname is not registered in the AD DNS server.

First step, the client computes an NTLM hash from the user's password. Then, it sends its username to the server, and the server replies with a nonce, which is random. Then, the client encrypts the nonce with its hash, and sends it to the server. The server forwards the response, the nonce and the username to the DC, which checks if the decrypted nonce matches the one sent by the server using user's hash. It then replies to the application server.  

## NTLMv1 vs NTLMv2 ?

NTLMv2 includes a timestamp in the request send by the client including its username, and the nonce has a random length, whereas it is 16-bytes long for NTLMv1. These changes help mitigating relay attacks.

## What is JWT and how to attack it ?

JWT stands for JSON Web Token. This is a self-contained way for securely transmitting information between parties as JSON objects. It is made of 3 parts. The first one (header) contains signature and cryptographic information. The second (payload) contains claims. The third (signature) contains signature itself. This is often used to contain session and user non confidential informations, and used as a session token. This is widely used in SSO authentication systems.

Here are some ways JWT can be attacked:
- Changing the algorithm to "none"
- Changing the algorithm RS256 to HS256 and use the public key as signing key
- Check for token expiry validation
- Various attacks with `kid`: Path traversal, OS injection, SQL injection ...
- Bruteforce secret key

## What is a XXE ?

XML External Entity is a web vulnerability that allows an attacker to attack an application processing XML data. It can be used to read arbitrary files, or to perform SSRF, by adding an XML entity to the data.

## What are the security HTTP cookie flags ?

HostOnly, HttpOnly, Secure

## Explain 3 way TCP handshake

First: The client sends a SYN packet to the server.
Second: The server replies with a SYN/ACK packet.
Third: The client replies with an ACK packet.

## How does serialization work ? How can it be exploited ? Give examples in at least two different languages/formats.

Serialization is a mechanism that allows to convert an object into a format that can be preserved and reused later. This allows to recreate an object with same propreties later. This process is called deserialization. Deserialization can be exploited if the attacker can manipulate serialized data to craft malicious objects.

For instance, PHP serialization can be exploited through the `__wakeup` or the `__destruct` methods.
Python `pickle` serialization can also be exploited with the `__reduce__` method.


## What is a CSRF ? How to protect from it ?

CSRF (Cross-Site Request Forgery) is a web attack that allows the attacker to perform actions on behalf of users by using their authenticated sessions. This is done by tricking the user to perform a request on the web application, for instance by automatically submitting a form.

To protect from it, CSRF tokens can be used, which are unique tokens linked ot each session and requested on each request. Cross-origin ressource sharing (CORS) policy can also be enhanced. Finally, modifying parameters names can also help preventing this attack.

## Can SSTI lead to RCE ?

Yes, for instance with Jinja in python, it is possible to access the `os` module and from there execute shell commands.

## What is OWASP Top 10 ? Give some entries of the top.

OWASP Top 10 is a list representing the 10 most critical security risks to web applications. Last update of the list was in 2021. It contains vulnerabilities like Broken Access Control, Cryptographic Failures, Injections or SSRF.

## What is the difference between symetric and assymetric encryption ? Pros/cons ?

Symmetric uses the same key for both encryption and decryption, whereas assymetric uses a public key for encryption and a private key for decryption.
Symmetric encryption's advantage is that the computations are faster than assymetric encryption. However, assymetric encryption is more secure as knowing how to encrypt a message does not need to know how to decrypt it.

## What is the difference between hash and encryption ?

A hash is a one-way mathematical operation that generates a fixed-length fingerprint vor variable-length input data. Each fingerprint is unique, and allows to check whether two chunks of data match or not.
Encryption is used to transform a readable plaintext into a unreadable ciphertext using a mathematical operation and an encryption key. It can then be decrypted, by knowing the decryption key.

## How would you define a risk ? A vulnerability ?

Cybersecurity risk is the potential harm resulting from a cyber attack or a data breach, and the consequences it can have on information systems, reputation, individuals, organizational operations or other organizations.
A vulnerability is a weakness in an information system, system security procedures, internal controls, or implementation that could be exploited or triggered by a threat source.

## What is CVSS ?

CVSS stands for Common Vulnerability Scoring System and is a tool provided by the NIST in order to better assess a vulnerability, based on its complexity, impact, and other criteria.

## What are the different TCP flags ?

- SYN: Used to initiate a communication
- ACK: Used to acknowledge recieved packets
- FIN: Used to request connection termination
- RST: Used to terminate connection if something seems wrong
- URG: Used to indicate data in this packet should be prioritized
- PSH: Used to request immediate data delivery without waiting for additionnal data to be buffered

## What is a SSRF ?

A SSRF (Server-Side Request Forgery) is a vulnerability that allows the attacker to send requests from the server. This can allow an attacker to access internal network, internal-only services, files, or to bypass host restrictions.

## What is an Open Redirect ?

An open redirection is a web vulnerability that allows an attacker to redirect the client to any arbitraty external domain through user input.

## What are common file uploads restrictions and how to bypass them ?

Common restrictions are:
- Extension based checks
- MIME type based checks
- Magic bytes based checks

In order to bypass those checks, an attacker can use multiple extensions, can change the MIME type on the request, or can craft polyglot files for example.

## What are the different types of XSS vulnerabilities ?

- Stored XSS: the payload is stored in the server side and is therefore persistent
- Reflected XSS: the payload comes from the request, and can only be triggered this way
- DOM XSS: the payload is processed by client-side JavaScript in an unsafe way
- Self XSS: the attack can only be performed by the victim itself by performing specific actions
- Server-side XSS: the payload is executed by the server when processing user input in an unsafe way

## What is an error blind SQLi ?

Blind means the attacker cannot see the result of the injection. Then, it is possible to instead perform queries that will raise an error depending on the result of a condition. If the attacker can distinguish between a successful query and an error, it is then possible to recover data.

## Explain the CIA triad

- Confidentiality: Only authorized parties can access the data
- Integrity: The data cannot be modified by a unauthorized party
- Availability: The data is always accessible to authorized parties

## What is a Buffer Overflow ?

A Buffer Overflow is a executable vulnerability that arises when the provided input is too big to fit in the allocated space for it, resulting in overwriting the program memory. This can result to arbitrary code execution in the context of the executable. 

## What is a Business Logic vulnerability ?

Business logic vulnerabilities are web application vulnerabilities based on flaws in the design or in the implementation of the application, that results in unintended behavior.

## What is AppArmor ? How does it work (briefly) ?

AppArmor is a Linux kernel-based security framework that provides mandatory access control for applications. It works by confining the behavior of an application to a specific profile, which defines what the application can and cannot do.

## What are the most common HTTP methods ?

- GET: Retrieves a resource from the server.
- POST: Submits data to be processed by the server.
- HEAD: Retrieves metadata about a resource, similar to GET, but without the response body.
- OPTIONS: Returns the HTTP methods supported by the server for a specific URL.

## What is a salt ?

A salt is a value that is appended to the password before hashing it in order to prevent the use of rainbow tables or any precomputed hash lists.

## What is 0x90 ?

`0x90` represent a NOP in machine code. This is an instruction nothing, and that is used in binary exploitation to construct NOP-slides to make sure that, not matter where the return pointer ends, it still ends up executing the shellcode.

## What is a forest ?
## Explain how a Linux system boots, from pressing the power on button to login screen.
## What is a Use-After-Free vulnerability ?
## What happens on the network when I plug my Ethernet wire ?
## What happens on the network when I request https://www.google.com/ with my web browser ?
## How would you remotely access a service that can only be accessed from within an internal network ?
## What is the difference between an OU and a Group ?
## What is a Windows Access Token ?
## What is the UAC ?
## What is an HMAC ?
## How can you quickly escape from a Docker environment ?
## What is the difference between containers and virtualization ?
## How do you test for Linux privilege escalation ? For Windows ? (no linpeas/winpeas)
## What is Mimikatz ? What is it used for ?
## Where are all accounts data located in an Active Directory ?
## What is inside /etc/passwd ?
## What are the phases of a pentest ?
## What is TLS ? SSL ?
## What is XPath injection ?
## What is SSL stripping ?
## What is certificate pinning ?
## What to do when you find hashes ?
## What is a Pass the Hash attack ?
## How does NTLM relay attack work ?
## What is a SOCKS proxy ? How does it differ with a VPN ?
## What is a LFI ?
## How could you attack an FTP service ?
## What is Broken Access Control vulnerability ?
## Explain what services run on these ports : 21,22,25,53,80,88,161,389,443,445,587,1433,3306,3389,5985,6379

21: FTP
22: SSH
25: SMTP
53: DNS
80: HTTP
88: Kerberos
161: SNMP
389: LDAP
443: HTTPS
445: SMB
587: SMTP/TLS
1433: MSSQL
3306: MySQL
3389: RDP
5985: WinRM
6379: Redis

## What is clickjacking ?
## What is a race condition ?
## What is SAML ?
## AES-CBC vs AES-ECB ?
## Difference between active and passive recon ?
## What is the principle of least privilege ?
## How to rate a vulnerability ?
## What is the difference between an IDS and an IPS ?
## Explain the full process of ARP spoofing attack.
## In what format are Windows and Linux hashes stored ?
## Where are cron jobs stored in Windows and Linux ?
## What is a golden ticket attack ? How can it be achieved ?
## What is an IDOR ?
## How can you prevent online and offline bruteforce attacks ?
## What is a Zone Tranfer attack ?
## What is a GPO ?
## How does dll hijacking work ?
## What is an Unquoted Service Path ?
## How do you attack a Wordpress ?
## What would you do after escalated privileges to the highest position (Domain Administrator/root) ?
## What is BGP ? How does it work ? How can it be attacked ?
## How does DHCP work ?
## What is Active Directory and why would anyone use it?
## Whatâ€™s the difference between Diffie-Hellman and RSA?
## What kind of attack is a standard Diffie-Hellman exchange vulnerable to?
## How do you attack Tomcat ?
## What is Exploit-DB ?
## What is the difference between a staged and an unstaged payload ?
## What is ASLR ?
## What is a reverse shell ?
## You have just compromised a MSSQL server. How can you get a shell ?
## What is a capability ?